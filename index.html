<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#006479">
    <meta name="description" content="Sistema de presupuesto de operación para cálculos contables y financieros">
    
    <title>Software de Presupuesto de Operación</title>
    
    <!-- Estilos -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- Íconos -->
    <link rel="icon" type="image/png" sizes="192x192" href="Icono.png">
    <link rel="apple-touch-icon" href="Icono.png">

    <!-- Manifiesto de la PWA -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Registro del Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./sw.js')
                .then(() => console.log('Service Worker registrado'))
                .catch((error) => console.log('Error registrando Service Worker:', error));
        }
    </script>
</head>
<body>
    <header>
        <h1>Presupuesto de Operación</h1>
        <p class="subtitle">Sistema integral para cálculos contables y presupuestarios</p>
    </header>

    <main>
        <!-- Presupuesto de Ventas -->
        <fieldset class="fade-in">
            <legend><h2>📊 Presupuesto de Ventas</h2></legend>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="producto">Producto</label>
                    <input name="producto" id="producto" type="text" placeholder="Nombre del producto" required>
                </div>
                
                <div class="form-group">
                    <label for="unidades">Unidades</label>
                    <input name="unidades" id="unidades" type="number" placeholder="Cantidad de unidades" min="0" step="1" required>
                </div>
                
                <div class="form-group">
                    <label for="precio">Precio unitario</label>
                    <input name="precio" id="precio" type="number" placeholder="Precio por unidad" min="0" step="0.01" required>
                </div>
            </div>
            
            <div class="result-display">
                <h3 id="totalPV">Total: Ingrese los datos para calcular</h3>
            </div>
            
            <input type="submit" value="Calcular Presupuesto de Ventas" onclick="calcularPresupuestoVentas()">
        </fieldset>
        <!-- Presupuesto de Producción -->
        <fieldset class="fade-in">
            <legend><h2>🏭 Presupuesto de Producción</h2></legend>
            
            <div class="result-display">
                <p id="totalPVR">Unidades a Vender: Complete el presupuesto de ventas primero</p>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="inventarioI">Inventario Inicial</label>
                    <input type="number" name="inventarioI" id="inventarioI" placeholder="Inventario inicial" min="0" step="1">
                </div>
                
                <div class="form-group">
                    <label for="inventarioF">Inventario Final</label>
                    <input type="number" name="inventarioF" id="inventarioF" placeholder="Inventario final deseado" min="0" step="1">
                </div>
                
                <div class="form-group">
                    <label for="precioII">Precio Inventario Inicial</label>
                    <input type="number" name="precioII" id="precioII" placeholder="Precio por unidad" min="0" step="0.01">
                </div>
            </div>
            
            <div class="result-display">
                <h4 id="UnidadesProducir">Unidades a producir: Complete los datos</h4>
            </div>
            
            <input type="submit" value="Calcular Presupuesto de Producción" onclick="calcularPresupuestoProduccion()">
        </fieldset>

        <!-- Presupuesto de Materia Prima Necesaria -->
        <fieldset class="fade-in">
            <legend><h2>🧱 Presupuesto de Materia Prima Necesaria</h2></legend>
            
            <div class="result-display">
                <p id="productoR">Producto: Complete el presupuesto de ventas primero</p>
            </div>
            
            <p class="text-secondary">Indique la cantidad de materias primas necesarias por unidad de producto:</p>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="a">Materia Prima A (unidades)</label>
                    <input type="number" id="a" name="a" placeholder="Cantidad por unidad" min="0" step="0.01">
                </div>
                
                <div class="form-group">
                    <label for="b">Materia Prima B (unidades)</label>
                    <input type="number" id="b" name="b" placeholder="Cantidad por unidad" min="0" step="0.01">
                </div>
                
                <div class="form-group">
                    <label for="c">Materia Prima C (unidades)</label>
                    <input type="number" id="c" name="c" placeholder="Cantidad por unidad" min="0" step="0.01">
                </div>
            </div>
            
            <div class="result-display">
                <p id="ResultadoUnidadesNecesariasA">Unidades Necesarias A: Complete los datos</p>
                <p id="ResultadoUnidadesNecesariasB">Unidades Necesarias B: Complete los datos</p>
                <p id="ResultadoUnidadesNecesariasC">Unidades Necesarias C: Complete los datos</p>
            </div>
            
            <input type="submit" value="Calcular Materia Prima Necesaria" onclick="presupuestoMPNecesaria()">
        </fieldset>
        <!-- Presupuesto de Materia Prima -->
        <fieldset class="fade-in">
            <legend><h2>📦 Presupuesto de Materia Prima</h2></legend>
            
            <div class="result-display">
                <h4>Unidades necesarias:</h4>
                <div id="unidadesNR">Complete el presupuesto anterior</div>
            </div>
            
            <h4 class="text-primary">Inventarios de Materia Prima A</h4>
            <div class="form-row">
                <div class="form-group">
                    <label for="inventarioIMPA">Inventario inicial MP A</label>
                    <input type="number" id="inventarioIMPA" name="inventarioIMPA" placeholder="Unidades iniciales" min="0" step="1">
                </div>
                
                <div class="form-group">
                    <label for="inventarioFMPA">Inventario final MP A</label>
                    <input type="number" name="inventarioFMPA" id="inventarioFMPA" placeholder="Unidades finales" min="0" step="1">
                </div>
                
                <div class="form-group">
                    <label for="pCompraMPA">Precio de Compra MP A</label>
                    <input type="number" name="pCompraMPA" id="pCompraMPA" placeholder="Precio por unidad" min="0" step="0.01">
                </div>
            </div>
            
            <h4 class="text-primary">Inventarios de Materia Prima B</h4>
            <div class="form-row">
                <div class="form-group">
                    <label for="inventarioIMPB">Inventario inicial MP B</label>
                    <input type="number" id="inventarioIMPB" name="inventarioIMPB" placeholder="Unidades iniciales" min="0" step="1">
                </div>
                
                <div class="form-group">
                    <label for="inventarioFMPB">Inventario final MP B</label> 
                    <input type="number" name="inventarioFMPB" id="inventarioFMPB" placeholder="Unidades finales" min="0" step="1">
                </div>
                
                <div class="form-group">
                    <label for="pCompraMPB">Precio de Compra MP B</label>
                    <input type="number" name="pCompraMPB" id="pCompraMPB" placeholder="Precio por unidad" min="0" step="0.01">
                </div>
            </div>
            
            <h4 class="text-primary">Inventarios de Materia Prima C</h4>
            <div class="form-row">
                <div class="form-group">
                    <label for="inventarioIMPC">Inventario inicial MP C</label>
                    <input type="number" id="inventarioIMPC" name="inventarioIMPC" placeholder="Unidades iniciales" min="0" step="1">
                </div>
                
                <div class="form-group">
                    <label for="inventarioFMPC">Inventario final MP C</label> 
                    <input type="number" name="inventarioFMPC" id="inventarioFMPC" placeholder="Unidades finales" min="0" step="1">
                </div>
                
                <div class="form-group">
                    <label for="pCompraMPC">Precio de Compra MP C</label>
                    <input type="number" name="pCompraMPC" id="pCompraMPC" placeholder="Precio por unidad" min="0" step="0.01">
                </div>
            </div>
            
            <div class="result-display">
                <h4 id="unidadesAComprar">Unidades a Comprar: Complete los datos</h4>
                <h4 id="totalCompra">Total de compra: Complete los datos</h4>
            </div>
            
            <input type="submit" value="Calcular Presupuesto de Materia Prima" onclick="presupuestoMP()">
        </fieldset>
        <!-- Tarjeta de Almacén -->
        <fieldset class="fade-in">
            <legend><h2>📋 Tarjeta de Almacén</h2></legend>
            
            <h3 class="text-primary">Costos de Inventario Inicial de Materia Prima</h3>
            <div class="form-row">
                <div class="form-group">
                    <label for="costoIIMPA">Costo Unitario MP A</label>
                    <input type="number" name="costoIIMPA" id="costoIIMPA" placeholder="Costo por unidad" min="0" step="0.01">
                </div>
                
                <div class="form-group">
                    <label for="costoIIMPB">Costo Unitario MP B</label>
                    <input type="number" name="costoIIMPB" id="costoIIMPB" placeholder="Costo por unidad" min="0" step="0.01">
                </div>
                
                <div class="form-group">
                    <label for="costoIIMPC">Costo Unitario MP C</label>
                    <input type="number" name="costoIIMPC" id="costoIIMPC" placeholder="Costo por unidad" min="0" step="0.01">
                </div>
            </div>
            
            <div class="form-group">
                <label for="metodoValuacion">Método de Valuación de Inventarios</label>
                <select name="tarjetaAlmacen" id="metodoValuacion">
                    <option value="">Seleccione un método</option>
                    <option value="peps">PEPS (Primeras Entradas, Primeras Salidas)</option>
                    <option value="ueps">UEPS (Últimas Entradas, Primeras Salidas)</option>
                    <option value="costoPromedio">Costo Promedio Ponderado</option>
                </select>
            </div>
            
            <input type="submit" value="Generar Tarjeta de Almacén" onclick="tarjetaAlmacen()">
            
            <div class="table-container">
                <div id="mostrarTarjeta"></div>
            </div>
        </fieldset>

        <!-- Presupuesto de Mano de Obra -->
        <fieldset class="fade-in">
            <legend><h2>👷 Presupuesto de Mano de Obra</h2></legend>
            
            <div class="result-display">
                <p id="unidadesP">Unidades a producir: Complete el presupuesto de producción</p>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="horasArt">Horas por Artículo</label>
                    <input type="number" name="horasArt" id="horasArt" placeholder="Ej: 24 horas" min="0" step="0.01">
                </div>
                
                <div class="form-group">
                    <label for="costoTotal">Costo por Hora</label> 
                    <input type="number" name="costoTotal" id="costoTotal" placeholder="Costo por hora trabajada" min="0" step="0.01">
                </div>
            </div>
            
            <div class="result-display">
                <h4 id="totalHrs">Total de Horas: Complete los datos</h4>
                <h4 id="manoObraP">Mano de Obra a pagar: Complete los datos</h4>
            </div>
            
            <input type="submit" value="Calcular Mano de Obra" onclick="presupuestoMO()">
        </fieldset>
        <!-- Presupuesto de Cargos Indirectos -->
        <fieldset class="fade-in">
            <legend><h2>⚙️ Presupuesto de Cargos Indirectos</h2></legend>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="materiaPI">Materia Prima Indirecta</label>
                    <input type="number" name="materiaPI" id="materiaPI" placeholder="Costo de MP indirecta" min="0" step="0.01">
                </div>
                
                <div class="form-group">
                    <label for="manoObraI">Mano de Obra Indirecta</label>
                    <input type="number" name="manoObraI" id="manoObraI" placeholder="Costo de MO indirecta" min="0" step="0.01">
                </div>
                
                <div class="form-group">
                    <label for="renta">Renta</label>
                    <input type="number" name="renta" id="renta" placeholder="Costo de renta" min="0" step="0.01">
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="energia">Energía</label>
                    <input type="number" name="energia" id="energia" placeholder="Costo de energía" min="0" step="0.01">
                </div>
                
                <div class="form-group">
                    <label for="mantenimiento">Mantenimiento</label>
                    <input type="number" name="mantenimiento" id="mantenimiento" placeholder="Costo de mantenimiento" min="0" step="0.01">
                </div>
                
                <div class="form-group">
                    <label for="varios">Gastos Varios</label>
                    <input type="number" name="varios" id="varios" placeholder="Otros gastos indirectos" min="0" step="0.01">
                </div>
            </div>
            
            <div class="result-display">
                <h4 id="totalCI">Total: Complete los datos</h4>
            </div>
            
            <input type="submit" value="Calcular Cargos Indirectos" onclick="presupuestoCargosIndirectos()">
        </fieldset>

        <!-- Presupuesto de Producción (Consolidado) -->
        <fieldset class="fade-in">
            <legend><h2>🏭 Presupuesto de Producción (Consolidado)</h2></legend>
            
            <div class="result-display">
                <p id="materiaPT">Materia Prima: Complete los presupuestos anteriores</p>
                <p id="manoObraT">Mano de Obra: Complete los presupuestos anteriores</p>
                <p id="cargosIndirectos">Cargos Indirectos: Complete los presupuestos anteriores</p>
                <h4 id="totalProduccion">Total de producción: Complete los datos</h4>
                <p id="unidadesProducidas">Unidades Producidas: Complete los datos</p>
                <h4 id="costoUnitario">Costo unitario: Complete los datos</h4>
            </div>
            
            <input type="submit" value="Calcular Presupuesto de Producción" onclick="presupuestoProduccion()">
        </fieldset>
        <!-- Presupuesto de Valuación de Artículos Terminados -->
        <fieldset class="fade-in">
            <legend><h2>📊 Presupuesto de Valuación de Artículos Terminados</h2></legend>
            
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Concepto</th>
                            <th>Unidades</th>
                            <th>Costo Unitario</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="font-bold">Inventario Inicial</td>
                            <td id="inventarioInicial" class="text-center">—</td>
                            <td id="precioIITab" class="text-center">—</td>
                            <td id="totalII" class="text-center font-bold">—</td>
                        </tr>
                        <tr>
                            <td class="font-bold">Unidades Producidas</td>
                            <td id="unidadesProducidasTab" class="text-center">—</td>
                            <td id="precioUP" class="text-center">—</td>
                            <td id="totalUP" class="text-center font-bold">—</td>
                        </tr>
                        <tr>
                            <td class="font-bold text-primary">Producción disponible</td>
                            <td id="unidadesDisp" class="text-center font-bold">—</td>
                            <td class="text-center">—</td>
                            <td id="totalDisp" class="text-center font-bold text-primary">—</td>
                        </tr>
                        <tr>
                            <td class="font-bold">Inventario Final</td>
                            <td id="inventarioFinal" class="text-center">—</td>
                            <td class="text-center">—</td>
                            <td class="text-center">—</td>
                        </tr>
                        <tr>
                            <td class="font-bold text-primary">Costo de Venta</td>
                            <td id="costoUnidades" class="text-center font-bold">—</td>
                            <td id="precioUP2" class="text-center">—</td>
                            <td id="totalCostoVenta" class="text-center font-bold text-primary">—</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <input type="submit" value="Calcular Valuación de Artículos" onclick="presupuestoArticulosTerminados()">
        </fieldset>

        <!-- Presupuesto de Gastos de Operación -->
        <fieldset class="fade-in">
            <legend><h2>💼 Presupuesto de Gastos de Operación</h2></legend>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="comisiones">Comisiones</label>
                    <input type="number" name="comisiones" id="comisiones" placeholder="Comisiones de ventas" min="0" step="0.01">
                </div>
                
                <div class="form-group">
                    <label for="sueldos">Sueldos</label>
                    <input type="number" name="sueldos" id="sueldos" placeholder="Sueldos administrativos" min="0" step="0.01">
                </div>
                
                <div class="form-group">
                    <label for="publicidad">Publicidad</label>
                    <input type="number" name="publicidad" id="publicidad" placeholder="Gastos de publicidad" min="0" step="0.01">
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="servicios">Servicios</label>
                    <input type="number" name="servicios" id="servicios" placeholder="Servicios generales" min="0" step="0.01">
                </div>
                
                <div class="form-group">
                    <label for="diversos">Gastos Diversos</label>
                    <input type="number" name="diversos" id="diversos" placeholder="Otros gastos operativos" min="0" step="0.01">
                </div>
            </div>
            
            <div class="result-display">
                <h4 id="totalGastosOperecion">Total Gastos de Operación: Complete los datos</h4>
            </div>
            
            <input type="submit" value="Calcular Gastos de Operación" onclick="presupuestosGastosOperacion()">
        </fieldset>
        <!-- Estados de Resultados Proyectados -->
        <fieldset class="fade-in">
            <legend><h2>📈 Estados de Resultados Proyectados</h2></legend>
            
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Concepto</th>
                            <th>Importe</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="font-bold">Ventas</td>
                            <td id="ventasRP" class="text-right font-bold">Complete los presupuestos anteriores</td>
                        </tr>
                        <tr>
                            <td>(-) Costo de Ventas</td>
                            <td id="costoDeVentas" class="text-right">Complete los presupuestos anteriores</td>
                        </tr>
                        <tr style="border-top: 2px solid var(--color-primary);">
                            <td class="font-bold text-primary">= Utilidad Bruta</td>
                            <td id="utilidadBruta" class="text-right font-bold text-primary">Complete los datos</td>
                        </tr>
                        <tr>
                            <td>(-) Gastos de Operación</td>
                            <td id="gastosOperacion" class="text-right">Complete los presupuestos anteriores</td>
                        </tr>
                        <tr style="border-top: 2px solid var(--color-secondary);">
                            <td class="font-bold text-secondary">= Utilidad de Operación</td>
                            <td id="utilidadOperacion" class="text-right font-bold text-secondary">Complete los datos</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <input type="submit" value="Generar Estado de Resultados" onclick="estadoResultadoProyectado()">
        </fieldset>
    </main>
        
    <script src="script.js"></script>
    <script src="mejoras.js"></script>
</body>
</html>